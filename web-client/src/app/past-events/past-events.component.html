<div class="past-events-container">

  <main class="past-events-main">
    <!-- Page Header -->
    <div class="page-header">
      <h1>Past Events</h1>
      <p>View your completed calendar events</p>
      <p class="sub-description">Review past meetings and their details</p>
    </div>

    <!-- Calendar Section -->
    <div class="calendar-section">
      <div class="calendar-header">
        <button class="nav-btn" (click)="previousMonth()" title="Previous Month">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"></polyline>
          </svg>
        </button>

        <h2 class="month-year">{{ getMonthYearString() }}</h2>

        <button class="nav-btn" (click)="nextMonth()" title="Next Month">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9,18 15,12 9,6"></polyline>
          </svg>
        </button>

        <button class="today-btn" (click)="goToToday()">Today</button>
      </div>

      <!-- Calendar Grid -->
      <div class="calendar-grid">
        <!-- Day Headers -->
        <div class="day-header">Sun</div>
        <div class="day-header">Mon</div>
        <div class="day-header">Tue</div>
        <div class="day-header">Wed</div>
        <div class="day-header">Thu</div>
        <div class="day-header">Fri</div>
        <div class="day-header">Sat</div>

        <!-- Calendar Days -->
        <div
          *ngFor="let day of calendarDays"
          class="calendar-day"
          [class.empty-day]="day === null"
          [class.today]="day && isToday(day)"
          [class.future-day]="day && isFutureDate(day)"
          [class.past-day]="day && !isFutureDate(day)"
          [class.has-events]="day && getEventReportsForDate(day).length > 0"
          (click)="day && onDateClick(day)"
        >
          <span *ngIf="day" class="day-number">{{ day.getDate() }}</span>
          <div *ngIf="day && getEventReportsForDate(day).length > 0" class="event-indicators">
            <div class="event-dot" *ngFor="let eventReport of getEventReportsForDate(day).slice(0, 3)"></div>
            <div *ngIf="getEventReportsForDate(day).length > 3" class="more-events">+{{ getEventReportsForDate(day).length - 3 }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Events Section -->
    <div class="events-section">
      <div class="events-header">
        <h3>Past Events</h3>
      </div>

      <div class="events-list" *ngIf="pastEvents.length > 0; else noEvents">
        <div class="event-item" *ngFor="let eventReport of pastEvents" (click)="onEventReportClick(eventReport)">
          <div class="event-header">
            <div class="event-title">{{ eventReport.event.title }}</div>
            <div class="event-actions">
              <!-- Red circle for empty link -->
              <div *ngIf="hasEmptyLink(eventReport.event)" class="warning-indicator" title="No meeting link was available">
                <div class="red-circle"></div>
              </div>
              <!-- Yellow bubble for sentBot -->
              <div *ngIf="eventReport.event.sentBot" class="sent-bot-indicator" title="Bot message was sent">
                <div class="yellow-bubble">ü§ñ</div>
              </div>
            </div>
          </div>

          <div class="event-details">
            <div class="event-time">{{ formatEventTime(eventReport.startDateTime) }}</div>
            <div *ngIf="eventReport.event.description" class="event-description">{{ eventReport.event.description }}</div>
            <div *ngIf="eventReport.event.location" class="event-location">üìç {{ eventReport.event.location }}</div>
            <div class="event-link">
              <a *ngIf="eventReport.event.link" [href]="eventReport.event.link" target="_blank" class="meeting-link">View Meeting Link</a>
              <span *ngIf="!eventReport.event.link" class="no-meeting-link">No Meeting Link</span>
            </div>
            <!-- Show transcript availability -->
            <div *ngIf="eventReport.transcript" class="transcript-available">
              üìù Transcript Available
            </div>
            <!-- Show platform logo -->
            <div class="meeting-platform">
              <img [src]="getPlatformLogo(eventReport.platform)" 
                   [alt]="eventReport.platform" 
                   class="platform-logo"
                   *ngIf="getPlatformLogo(eventReport.platform)">
            </div>
          </div>

          <div class="event-controls">
            <div class="event-status">
              <span class="status-badge completed">Completed</span>
            </div>
          </div>
        </div>
      </div>

      <ng-template #noEvents>
        <div class="no-events">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          <h4>No past events</h4>
          <p>No completed events found for the selected time period.</p>
        </div>
      </ng-template>
    </div>

  </main>

</div>
